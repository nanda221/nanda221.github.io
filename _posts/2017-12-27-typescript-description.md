---
layout: post
title:  "TypeScript Description File(.d.ts) Practice"
subtitle: "对TS描述文件的理解和实践，帮助对TS有兴趣但对描述文件耿耿于怀的朋友get over it."
date:   2017-12-27 23:59:59 +0800
background: '/img/posts/06.jpg'
---

## 需要描述文件的场景

1. 页面开发：
   * ts文件使用了CDN资源(script标签引入)提供的能力。能力通过全局变量或者通过模块加载机制(如AMD、CommonJS)又或者兼容二者的方式(UMD)被ts文件使用。
    * 使用npm来做资源管理(如现在主流的webpack项目)，ts文件通过模块加载机制(如CommonJS、ES6 module)使用三方库的能力。
2. NodeJS开发：和上述第二点情况相同。

## 描述文件帮助我们做什么

描述文件做什么，和TS的设计目标是一致的：提供类似静态语言的能力，在开发时(IDE支持)、编译时做接口(这里的接口取广义)类型检查和提示，让代码的开发和维护更可预测(predictable)。
试想，为了完成$.ajax请求，我们会先打开jQuery文档，确定传递了“合适”的参数，下一步就是打开浏览器看效果。如果使用TS，那么它“仅仅”会帮我们多做三件事：
  1. 代码输入时API提示；
  2. 调用参数检查(字段&类型)；
  3. 执行结果类型声明。

这三步，让开发者更方便、更正确地使用别人的API(对于$.ajax来说，可以看到所有的overload方法，选择最合适的一个)，也让后续的维护(阅读和修改)更有自信。

一切都很美好，但是我拿到的是一份再普通不过的jQuery文件，上面的美好该如何发生呢？
是的，jQuery使用普通js语法编写，没有任何类型声明。那么我们可以：

1. 映入脑海的第一想法：我要用TS把它重写一次！带来的问题首先是成本，一些微型三方库还可行，但jQuery这种体量的想想就怕，而且它还在不断迭代。其次的问题是：重写后的jQuery.ts需要和调用文件在同一仓库，否则无论是CDN还是npm包管理都需要先编译成JS。